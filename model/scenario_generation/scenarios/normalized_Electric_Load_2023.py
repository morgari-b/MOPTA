


import pandas as pd

LOAD_23=pd.read_excel('scenarios/monthly_hourly_load_values_2023.xlsx', usecols=['DateUTC','CountryCode','Value'],index_col='DateUTC')

load=pd.DataFrame()
for country in LOAD_23['CountryCode'].unique():
    load[country]=LOAD_23.loc[LOAD_23['CountryCode']==country]['Value'].groupby('DateUTC').mean().asfreq('h',method='ffill')
load['AL'].loc[:'2023-12-05 22:00:00']=load['AL'].loc[:'2023-12-05 22:00:00'].div(load['AL'].loc[:'2023-12-05 22:00:00'].mean())
load['AL'].loc['2023-12-05 23:00:00':]=load['AL'].loc['2023-12-05 23:00:00':].div(load['AL'].loc['2023-12-05 23:00:00':].mean())
load=load.div(load.mean())

#%%

load.to_csv('scenarios/electricity_load.csv')

#%%

"""

load.mean()

AL      259.437158   ---> corrected: 204.639644
AT     6645.657078
BA     1194.988203
BE     9007.133127
BG     4116.686243
CH     6971.540430
CZ     6954.844998
DE    52280.658229
DK     3936.224241
EE      921.556273
ES    26177.184589
FI     9012.129809
FR    48598.654281
GB      790.028863
GE     1588.680035
GR     5465.439269
HR     2036.473345
HU     4805.877644
IE     3969.057794
IT    31532.209018
LT     1337.591019
LU      536.176585
LV      738.405879
MD      628.609874
ME      327.627748
MK      645.616452
NL    12470.581048
NO    15352.994098
PL    18961.386031
PT     5791.007095
RO     6088.715919
RS     3848.571804
SE    14910.885604
SI     1399.711745
SK     2902.644817
XK      733.854211
dtype: float64


[     204.63964352,  6645.65707763,  1194.9882032 ,  9007.13312657,
     4116.68624315,  6971.54043037,  6954.84499772, 52280.65822874,
     3936.22424144,   921.55627283, 26177.18458904,  9012.12980879,
    48598.65428082,   790.02886323,  1588.68003482,  5465.43926941,
     2036.47334475,  4805.87764355,  3969.05779395, 31532.20901826,
     1337.59101884,   536.17658533,   738.405879  ,   628.60987443,
      327.62774829,   645.61645205, 12470.58104752, 15352.99409817,
    18961.38603139,  5791.00709475,  6088.71591852,  3848.57180365,
    14910.88560388,  1399.71174543,  2902.64481735,   733.85421062]

"""

